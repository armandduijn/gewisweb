<?php
// set title
$this->headTitle($this->translate('Members')); ?>

<?php

$sections = [];
$sections[$this->translate('Personal')] = [
    [$this->translate('Change password'), 'lock', $this->url('user/default', ['action' => 'password'])],
];

/** @var \Decision\Model\Meeting[] $meetings */
$meetings = $this->meetings;
?>
<style>
    .row-spacing-top {
        margin-top: 2rem;
    }
</style>


<div class="container">
    <section class="section">
        <div class="row">
            <div class="col-md-12">
                <h1><?= $this->translate('Members') ?></h1>
            </div>
        </div>
        <div class="row row-spacing-top">
            <div class="col-md-12">
                <h2><?= $this->translate('Personal') ?></h2>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); grid-gap: 1rem;">
                    <a href="<?= $this->url('member/self') ?>" class="panel panel-image">
                        <div class="glyphicon glyphicon-user"></div>
                        <div class="h4"><?= $this->translate('Profile') ?></div>
                    </a>
                    <a href="<?= $this->url('photo/member', ['lidnr' => $member->getLidnr(), 'page' => null]) ?>" class="panel panel-image">
                        <div class="glyphicon glyphicon-picture"></div>
                        <div class="h4"><?= $this->translate('My photo\'s') ?></div>
                    </a>
                    <a href="https://gewis.nl/susos/account/websitelogin.php" class="panel panel-image">
                        <div class="glyphicon glyphicon-glass"></div>
                        <div class="h4"><?= $this->translate('SuSOS') ?></div>
                    </a>
                    <a href="<?= $this->url('decision/authorizations') ?>" class="panel panel-image">
                        <div class="glyphicon glyphicon glyphicon-bullhorn"></div>
                        <div class="h4"><?= $this->translate('Authorizations') ?></div>
                    </a>
                    <a href="<?= $this->url('member/search') ?>" class="panel panel-image">
                        <div class="glyphicon glyphicon-search"></div>
                        <div class="h4"><?= $this->translate('Find a member') ?></div>
                    </a>
                </div>
            </div>
        </div>
        <div class="row row-spacing-top" style="margin-top: 5rem;">
            <div class="col-md-6">
                <h2><?= $this->translate('Meetings') ?></h2>
                <?php if (!is_null($this->upcoming)): ?>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <strong><?= $this->translate('Upcoming meeting') ?></strong>
                        </div>
                        <div class="panel-body">
                            <?=
                                sprintf(
                                    $this->translate('The next meeting is %s%s %s%s on %s.'),
                                    '<a href="' . $this->url('decision/meeting', [ 'type' => $this->upcoming->getType(), 'number' => $this->upcoming->getNumber() ]) . '">',
                                    $this->upcoming->getType(),
                                    $this->upcoming->getNumber(),
                                    '</a>',
                                    $this->upcoming->getDate()->format('l j F Y')
                                )
                            ?>
                        </div>
                    </div>
                    <p>
                        <?=
                            sprintf(
                                $this->translate('If you are not able to attend the meeting in person but you want your voice to be heard, consider %sauthorizing another member%s to act on your behalf.'),
                                '<a href="' . $this->url('decision/authorizations') . '">',
                                '</a>'
                            )
                        ?>
                    </p>
                    <hr />
                <?php endif; ?>
                <p><?= $this->translate('Search through the list of decisions accumulated from past meetings.') ?></p>
                <form method="post" action="<?= $this->url('decision/search') ?>" class="form-inline">
                    <input type="text" name="query" class="form-control" placeholder="<?= $this->translate('Search by keyword or meeting number') ?>" />
                    <button type="submit" class="btn btn-default">
                        <?= $this->translate('Search') ?>
                    </button>
                </form>
                <hr />
                <p><?= $this->translate('The last five meetings that took place:') ?></p>
                <ul>
                    <?php foreach($meetings as $meeting): ?>
                        <li>
                            <a href="<?= $this->url('decision/meeting', [ 'type' => $meeting->getType(), 'number' => $meeting->getNumber() ]) ?>">
                                <?=
                                    sprintf(
                                        $this->translate('%s %s on %s'),
                                        $meeting->getType(),
                                        $meeting->getNumber(),
                                        $meeting->getDate()->format('l j F Y')
                                    )
                                ?>
                            </a>
                        </li>
                    <?php endforeach; ?>
                </ul>
                <a href="<?= $this->url('decision') ?>">
                    <?= $this->translate('View all meetings') ?>
                </a>
            </div>
            <?php if ($this->acl('decision_acl')->isAllowed('organ', 'edit')): ?>
                <div class="col-md-6">
                    <h2><?= $this->translate('Manage') ?></h2>
                    <p><?= $this->translate('A list of helpful pages to manage the organ(s) you are part of.') ?></p>
                    <style>
                        .panel-image { margin: 0; padding 0; }
                    </style>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); grid-gap: 1rem;">
                        <a href="<?= $this->url('activity_admin') ?>" class="panel panel-image">
                            <div class="glyphicon glyphicon-tree-deciduous"></div>
                            <div class="h4"><?= $this->translate('Activities') ?></div>
                        </a>
                        <a href="<?= $this->url('admin_organ') ?>" class="panel panel-image">
                            <div class="glyphicon glyphicon-align-left"></div>
                            <div class="h4"><?= $this->translate('Organ page') ?></div>
                        </a>
                        <a href="<?= $this->url('activity_calendar') ?>" class="panel panel-image">
                            <div class="glyphicon glyphicon-calendar"></div>
                            <div class="h4"><?= $this->translate('Option calendar') ?></div>
                        </a>
                        <a href="/webmail" class="panel panel-image">
                            <div class="glyphicon glyphicon-inbox"></div>
                            <div class="h4"><?= $this->translate('Webmail') ?></div>
                        </a>
                        <a href="<?= $this->url('admin') ?>" class="panel panel-image">
                            <div class="glyphicon glyphicon-cog"></div>
                            <div class="h4"><?= $this->translate('Administrator') ?></div>
                        </a>
                    </div>
                </div>
            <?php endif; ?>
        </div>
        <?php if ($this->acl('decision_acl')->isAllowed('organ', 'edit')): ?>
        <div class="row row-spacing-top">
            <div class="col-md-12">
                <h2><?= $this->translate('Regulations') ?></h2>
                <ul>
                    <li>
                        <a href="<?= $this->url('member/regulations', ['regulation' => 'borrel-reglement']) ?>">
                            <?= $this->translate('Borrelreglement') ?>
                        </a>
                    </li>
                    <li>
                        <a href="<?= $this->url('member/regulations', ['regulation' => 'computer-reglement']) ?>">
                            <?= $this->translate('Computerreglement') ?>
                        </a>
                    </li>
                    <li>
                        <a href="<?= $this->url('member/regulations', ['regulation' => 'poster-reglement']) ?>">
                            <?= $this->translate('Posterreglement') ?>
                        </a>
                    </li>
                    <li>
                        <a href="<?= $this->url('member/regulations', ['regulation' => 'sleutel-beleid']) ?>">
                            <?= $this->translate('Sleutelbeleid') ?>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <?php endif; ?>
    </section>
</div>

